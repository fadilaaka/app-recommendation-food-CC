// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "mysql"
    url      = env("DATABASE_URL")
}

enum status {
    publish
    unpublish
}

model Admin {
    id       Int     @id @default(autoincrement())
    uuid     String  @unique
    email    String  @unique
    password String?
    name     String?

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?
}

model User {
    id       Int       @id @default(autoincrement())
    uuid     String    @unique
    email    String    @unique
    password String?
    name     String?
    gender   String?
    birthday DateTime? @db.Date
    weight   Float?
    height   Float?
    budget   Int?

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    userDetail             UserDetail?
    userTokenResetPassword userTokenResetPassword[]
}

model DiseaseHistory {
    id          Int     @id @default(autoincrement())
    uuid        String  @unique
    name        String
    description String? @db.LongText

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    userDetail                 UserDetail[]
    userDetailOnDiseaseHistory userDetailOnDiseaseHistory[]
}

model Allergy {
    id          Int     @id @default(autoincrement())
    uuid        String  @unique
    name        String
    description String? @db.LongText

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    userDetail         UserDetail[]
    userDetailOnAlergy userDetailOnAlergy[]
}

model ActivityFactor {
    id          Int     @id @default(autoincrement())
    uuid        String  @unique
    name        String
    description String? @db.LongText

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    userDetail UserDetail[]
}

model StressFactor {
    id          Int     @id @default(autoincrement())
    uuid        String  @unique
    name        String
    description String? @db.LongText

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    userDetail UserDetail[]
}

model UserDetail {
    id   Int    @id @default(autoincrement())
    uuid String @unique

    userId           Int  @unique
    diseaseHistoryId Int?
    allergyId        Int?
    activityFactorId Int?
    stressFactorId   Int?

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    user             User                         @relation(fields: [userId], references: [id])
    allergy          Allergy?                     @relation(fields: [allergyId], references: [id])
    diseaseHistory   DiseaseHistory?              @relation(fields: [diseaseHistoryId], references: [id])
    activityFactor   ActivityFactor?              @relation(fields: [activityFactorId], references: [id])
    stressFactor     StressFactor?                @relation(fields: [stressFactorId], references: [id])
    allergies        userDetailOnAlergy[]
    diseaseHistories userDetailOnDiseaseHistory[]
}

model userDetailOnAlergy {
    id   Int    @id @default(autoincrement())
    uuid String @unique

    userDetailId Int
    allergyId    Int

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    userDetail UserDetail @relation(fields: [userDetailId], references: [id])
    allergy    Allergy    @relation(fields: [allergyId], references: [id])
}

model userDetailOnDiseaseHistory {
    id   Int    @id @default(autoincrement())
    uuid String @unique

    userDetailId     Int
    diseaseHistoryId Int

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    userDetail     UserDetail     @relation(fields: [userDetailId], references: [id])
    diseaseHistory DiseaseHistory @relation(fields: [diseaseHistoryId], references: [id])
}

model Food {
    id          Int     @id @default(autoincrement())
    uuid        String  @unique
    name        String
    description String? @db.LongText
    image       String? @db.LongText
    price       Float?
    status      status  @default(publish)

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    foodDetail     FoodDetail[]
    foodTagsOnFood FoodTagsOnFood[]
    foodRecipe     FoodRecipe[]
}

model FoodDetail {
    id          Int    @id @default(autoincrement())
    uuid        String @unique
    fat         Float?
    protein     Float?
    carbohidrat Float?
    calories    Float?

    foodId Int

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    food Food @relation(fields: [foodId], references: [id], onDelete: Cascade, onUpdate: Cascade)
}

model FoodRecipe {
    id          Int     @id @default(autoincrement())
    uuid        String  @unique
    name        String
    description String? @db.LongText
    image       String? @db.LongText

    foodId Int?

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    food Food? @relation(fields: [foodId], references: [id])
}

model FoodTags {
    id          Int     @id @default(autoincrement())
    uuid        String  @unique
    name        String
    description String? @db.LongText
    image       String?

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    foodTagsOnFood FoodTagsOnFood[]
}

model FoodTagsOnFood {
    id   Int    @id @default(autoincrement())
    uuid String @unique

    foodId     Int
    foodTagsId Int

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    food     Food     @relation(fields: [foodId], references: [id], onDelete: Cascade, onUpdate: Cascade)
    foodTags FoodTags @relation(fields: [foodTagsId], references: [id], onUpdate: Cascade)
}

model Article {
    id          Int     @id @default(autoincrement())
    uuid        String  @unique
    title       String
    description String? @db.LongText
    image       String? @db.LongText
    status      status  @default(publish)

    articleCategoryId Int?

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    articleCategory   ArticleCategory?           @relation(fields: [articleCategoryId], references: [id])
    articleCategories ArticleCategoryOnArticle[]
}

model ArticleCategory {
    id          Int     @id @default(autoincrement())
    uuid        String  @unique
    name        String
    description String? @db.LongText
    image       String?

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    article           Article[]
    articleCategories ArticleCategoryOnArticle[]
}

model ArticleCategoryOnArticle {
    id   Int    @id @default(autoincrement())
    uuid String @unique

    articleId         Int
    articleCategoryId Int

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    article         Article         @relation(fields: [articleId], references: [id], onDelete: Cascade, onUpdate: Cascade)
    articleCategory ArticleCategory @relation(fields: [articleCategoryId], references: [id], onUpdate: Cascade)
}

model userTokenResetPassword {
    id   Int    @id @default(autoincrement())
    uuid String @unique

    userId Int
    token  String   @unique
    expire DateTime
    isUsed Boolean  @default(false)

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    user User @relation(fields: [userId], references: [id])
}
