// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "mysql"
    url      = env("DATABASE_URL")
}

enum status {
    publish
    unpublish
}

model User {
    id       Int      @id @default(autoincrement())
    uuid     String   @unique
    email    String   @unique
    password String?
    name     String?
    gender   String?
    birthday DateTime
    weight   Float?
    height   Float?
    budget   Int?

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    userDetail UserDetail?
}

model DiseaseHistory {
    id          Int     @id @default(autoincrement())
    uuid        String  @unique
    name        String
    description String?

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    userDetail                 UserDetail[]
    userDetailOnDiseaseHistory userDetailOnDiseaseHistory[]
}

model Allergy {
    id          Int     @id @default(autoincrement())
    uuid        String  @unique
    name        String
    description String?

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    userDetail         UserDetail[]
    userDetailOnAlergy userDetailOnAlergy[]
}

model ActivityFactor {
    id          Int     @id @default(autoincrement())
    uuid        String  @unique
    name        String
    description String?

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    userDetail UserDetail[]
}

model StressFactor {
    id          Int     @id @default(autoincrement())
    uuid        String  @unique
    name        String
    description String?

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    userDetail UserDetail[]
}

model UserDetail {
    id   Int    @id @default(autoincrement())
    uuid String @unique

    userId           Int  @unique
    diseaseHistoryId Int?
    allergyId        Int?
    activityFactorId Int?
    stressFactorId   Int?

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    user             User                         @relation(fields: [userId], references: [id])
    allergy          Allergy?                     @relation(fields: [allergyId], references: [id])
    diseaseHistory   DiseaseHistory?              @relation(fields: [diseaseHistoryId], references: [id])
    activityFactor   ActivityFactor?              @relation(fields: [activityFactorId], references: [id])
    stressFactor     StressFactor?                @relation(fields: [stressFactorId], references: [id])
    allergies        userDetailOnAlergy[]
    diseaseHistories userDetailOnDiseaseHistory[]
}

model userDetailOnAlergy {
    id   Int    @id @default(autoincrement())
    uuid String @unique

    userDetailId Int
    allergyId    Int

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    userDetail UserDetail @relation(fields: [userDetailId], references: [id])
    allergy    Allergy    @relation(fields: [allergyId], references: [id])
}

model userDetailOnDiseaseHistory {
    id   Int    @id @default(autoincrement())
    uuid String @unique

    userDetailId     Int
    diseaseHistoryId Int

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    userDetail     UserDetail     @relation(fields: [userDetailId], references: [id])
    diseaseHistory DiseaseHistory @relation(fields: [diseaseHistoryId], references: [id])
}

model Food {
    id          Int     @id @default(autoincrement())
    uuid        String  @unique
    name        String
    description String?
    image       String?
    price       Float?
    status      status  @default(publish)

    foodRecipeId Int?
    foodTagsId   Int?

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    foodDetail     FoodDetail[]
    foodRecipe     FoodRecipe?      @relation(fields: [foodRecipeId], references: [id])
    foodTags       FoodTags?        @relation(fields: [foodTagsId], references: [id])
    foodTagsOnFood FoodTagsOnFood[]
}

model FoodDetail {
    id          Int    @id @default(autoincrement())
    uuid        String @unique
    fat         Float?
    protein     Float?
    carbohidrat Float?
    calories    Float?

    foodRecipeId Int?
    foodId       Int

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    food       Food        @relation(fields: [foodId], references: [id])
    foodRecipe FoodRecipe? @relation(fields: [foodRecipeId], references: [id])
}

model FoodRecipe {
    id          Int     @id @default(autoincrement())
    uuid        String  @unique
    name        String
    description String?
    image       String?

    foodId Int

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    food       Food[]
    foodDetail FoodDetail[]
}

model FoodTags {
    id          Int     @id @default(autoincrement())
    uuid        String  @unique
    name        String
    description String?
    image       String?

    foodId Int?

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    food           Food[]
    foodTagsOnFood FoodTagsOnFood[]
}

model FoodTagsOnFood {
    id   Int    @id @default(autoincrement())
    uuid String @unique

    foodId     Int
    foodTagsId Int

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    food     Food     @relation(fields: [foodId], references: [id])
    foodTags FoodTags @relation(fields: [foodTagsId], references: [id])
}

model Article {
    id          Int     @id @default(autoincrement())
    uuid        String  @unique
    title       String
    description String?
    image       String?
    status      status  @default(publish)

    articleCategoryId Int?

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    articleCategory          ArticleCategory?           @relation(fields: [articleCategoryId], references: [id])
    articleCategoryOnArticle ArticleCategoryOnArticle[]
}

model ArticleCategory {
    id          Int     @id @default(autoincrement())
    uuid        String  @unique
    name        String
    description String?
    image       String?

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    article                  Article[]
    articleCategoryOnArticle ArticleCategoryOnArticle[]
}

model ArticleCategoryOnArticle {
    id   Int    @id @default(autoincrement())
    uuid String @unique

    articleId         Int
    articleCategoryId Int

    createdAt DateTime  @default(now())
    updatedAt DateTime  @updatedAt
    deletedAt DateTime?

    article         Article         @relation(fields: [articleId], references: [id])
    articleCategory ArticleCategory @relation(fields: [articleCategoryId], references: [id])
}
